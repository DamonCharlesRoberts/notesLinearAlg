<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.549">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Notes on Practical Linear Algebra for Data Science by Mike X Cohen - 10&nbsp; Row reduction and LU Decomposition</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./ch_11.html" rel="next">
<link href="./ch_9.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./ch_10.html"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Row reduction and LU Decomposition</span></a></li></ol></nav>
        <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Notes on <em>Practical Linear Algebra for Data Science</em> by Mike X Cohen</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">What this is</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ch_2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Vectors, Part I</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ch_3.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Vectors Part II</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ch_4.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Vector Applications</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ch_5.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Matrices, Part I</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ch_6.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Matrices, Part II</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ch_7.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Matrix applications</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ch_8.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Matrix Inverse</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ch_9.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Orthogonal matrices and QR decomposition.</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ch_10.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Row reduction and LU Decomposition</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ch_11.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">General Linear Models (GLM) and Least Squares</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ch_12.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Least Squares applications</span></span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#key-points" id="toc-key-points" class="nav-link active" data-scroll-target="#key-points"><span class="header-section-number">10.1</span> Key points</a></li>
  <li><a href="#systems-of-equations" id="toc-systems-of-equations" class="nav-link" data-scroll-target="#systems-of-equations"><span class="header-section-number">10.2</span> Systems of equations</a></li>
  <li><a href="#matrices-as-systems" id="toc-matrices-as-systems" class="nav-link" data-scroll-target="#matrices-as-systems"><span class="header-section-number">10.3</span> Matrices as systems</a>
  <ul class="collapse">
  <li><a href="#working-withsolving-matrices-as-systems" id="toc-working-withsolving-matrices-as-systems" class="nav-link" data-scroll-target="#working-withsolving-matrices-as-systems"><span class="header-section-number">10.3.1</span> Working with/solving matrices as systems</a></li>
  <li><a href="#row-reduction" id="toc-row-reduction" class="nav-link" data-scroll-target="#row-reduction"><span class="header-section-number">10.3.2</span> Row reduction</a></li>
  </ul></li>
  <li><a href="#gaussian-elimination" id="toc-gaussian-elimination" class="nav-link" data-scroll-target="#gaussian-elimination"><span class="header-section-number">10.4</span> Gaussian Elimination</a></li>
  <li><a href="#gauss-jordan-elimination" id="toc-gauss-jordan-elimination" class="nav-link" data-scroll-target="#gauss-jordan-elimination"><span class="header-section-number">10.5</span> Gauss-Jordan Elimination</a></li>
  <li><a href="#lu-decomposition" id="toc-lu-decomposition" class="nav-link" data-scroll-target="#lu-decomposition"><span class="header-section-number">10.6</span> LU Decomposition</a></li>
  <li><a href="#row-swapping-with-permutation-matrices" id="toc-row-swapping-with-permutation-matrices" class="nav-link" data-scroll-target="#row-swapping-with-permutation-matrices"><span class="header-section-number">10.7</span> Row swapping with Permutation matrices</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Row reduction and LU Decomposition</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<div id="setup" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load packages.</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">LinearAlgebra</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="key-points" class="level2" data-number="10.1">
<h2 data-number="10.1" class="anchored" data-anchor-id="key-points"><span class="header-section-number">10.1</span> Key points</h2>
<ul>
<li>When working with a system of matrices, we need to apply manipulations to both sides and in the same order – they are noncommunicative.</li>
<li>Row reduction allows us to take the rows of matrix <span class="math inline">\(A\)</span> and scalar multiply then add them until we have an upper-triangular matrix, <span class="math inline">\(U\)</span>. The linear transformations can be recorded in our transformation matrix,, <span class="math inline">\(L\)</span>, which left multiplies <span class="math inline">\(A\)</span>. That is <span class="math inline">\(L^{-1}A = U\)</span></li>
<li>We use row reduction in LU decomposition. The result is unique so long as there is a square and full rank matrix.</li>
</ul>
</section>
<section id="systems-of-equations" class="level2" data-number="10.2">
<h2 data-number="10.2" class="anchored" data-anchor-id="systems-of-equations"><span class="header-section-number">10.2</span> Systems of equations</h2>
<ul>
<li>LU decomposition is essentially solving a series of systems of equations. Here’s some examples of how to algebraically solve them.</li>
</ul>
<p><span class="math display">\[
\begin{aligned}
    x = 4-y\\
    y = \frac{x}{2} + 2\\
    \\
    x = 4 - (\frac{1}{2}x + 2) \\
    \frac{3}{2}x = 4 - 2\\
    x = \frac{4}{3}\\
    y = \frac{4}{3}^{-2} + 2 \\
    y = \frac{2}{3} + \frac{6}{3} = \frac{8}{3}
\end{aligned}
\]</span></p>
</section>
<section id="matrices-as-systems" class="level2" data-number="10.3">
<h2 data-number="10.3" class="anchored" data-anchor-id="matrices-as-systems"><span class="header-section-number">10.3</span> Matrices as systems</h2>
<ul>
<li>Take the following system: <span class="math display">\[
\begin{aligned}
  x + y = 4 \\
  -\frac{x}{2} + y = 4\\
\end{aligned}
\]</span>
<ul>
<li>In matrix form, it would be re-expressed as: <span class="math display">\[
\begin{bmatrix}
  1&amp;1\\
  -\frac{1}{2}&amp;1
\end{bmatrix}\begin{bmatrix}
  x\\
  y
\end{bmatrix} = \begin{bmatrix}
  4\\
  2
\end{bmatrix}
\]</span></li>
</ul></li>
<li>You essentially create a matrix of scalars, then a column vector of variables which is equivalent to the vector of scalars.</li>
<li>This is what is represented when we have <span class="math inline">\(Ax = b\)</span>.
<ul>
<li><span class="math inline">\(A\)</span> is our matrix of scalars called our coefficients.</li>
<li><span class="math inline">\(x\)</span> is our vector of variables.</li>
<li><span class="math inline">\(b\)</span> is our vector of constants.</li>
</ul></li>
</ul>
<section id="working-withsolving-matrices-as-systems" class="level3" data-number="10.3.1">
<h3 data-number="10.3.1" class="anchored" data-anchor-id="working-withsolving-matrices-as-systems"><span class="header-section-number">10.3.1</span> Working with/solving matrices as systems</h3>
<ul>
<li>What you do to one-side, you must do to the other.</li>
<li>The order matters. If you pre-multiply a matrix/vector on one-side you have to do it on the other.
<ul>
<li>E.g.
<ul>
<li>The following is valid. <span class="math display">\[
  \begin{aligned}
  AX = B\\
  CAX = CB\\
  \end{aligned}
  \]</span></li>
<li>The following is invalid. <span class="math display">\[
  \begin{aligned}
  AX = B\\
  AXC = CB\\
  \end{aligned}
  \]</span></li>
</ul></li>
</ul></li>
</ul>
</section>
<section id="row-reduction" class="level3" data-number="10.3.2">
<h3 data-number="10.3.2" class="anchored" data-anchor-id="row-reduction"><span class="header-section-number">10.3.2</span> Row reduction</h3>
<div class="callout callout-style-default callout-note callout-titled" title="Definitions">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Definitions
</div>
</div>
<div class="callout-body-container callout-body">
<p>Echelon form matrix - The resulting upper triangular matrix from row reduction - The leftmost nonzero number in a row (called the pivote) is to the right of the pivote of the rows above. - Any rows of all zerios are below rows containing nonzeros.</p>
</div>
</div>
<ul>
<li>The building block for LU decomposition.</li>
<li>It is the way to solve systems of equations by hand and is very well-known in linear algebra. However, you often do not actually do it by hand. It is useful to know about as it leads to LU decomposition.</li>
<li>Row reduction
<ul>
<li>You iteratively apply two operations to rows of a matrix:
<ol type="1">
<li>scalar multiplication</li>
<li>scalar addition</li>
</ol></li>
<li>It is the matrix system way of adding equations to other equations within a system (solving a system with substitution).</li>
<li>The goal of row reduction: transform a dense matrix into a upper-triangular matrix via row manipulations that we implement by premultiplying a transformation matrix.</li>
</ul></li>
<li>Example: <span class="math display">\[
  \begin{bmatrix}
      2&amp;3\\
      -2&amp;2\\
  \end{bmatrix} \xrightarrow{R_1 + R2} \begin{bmatrix}
      2&amp;3\\
      0&amp;5\\
  \end{bmatrix}
  \]</span>
<ul>
<li>We get this upper triangular matrix by adding the first row to the second row.</li>
<li>This upper triangular matrix is called the <strong>echelon form</strong> of the matrix</li>
</ul></li>
<li>Though the echelon form is different than the original matrix, it is connected to the original matrix through a linear combination. We can represent this as: <span class="math display">\[
\begin{bmatrix}
  1&amp;0\\
  1&amp;1\\
\end{bmatrix}\begin{bmatrix}
  2&amp;3\\
  -2&amp;2\\
\end{bmatrix} = \begin{bmatrix}
  2&amp;3\\
  0&amp;5\\
\end{bmatrix}
\]</span>
<ul>
<li>This is often represented as <span class="math inline">\(L^{-1}A = U\)</span> where <span class="math inline">\(L^{-1}\)</span> represents the linear transformations that we have implemented as a way to keep track of what manipulations we have done with row reduction.</li>
</ul></li>
<li>The problem with row reduction is that it is tedius and that the echelon form of a matrix is not unique.</li>
</ul>
</section>
</section>
<section id="gaussian-elimination" class="level2" data-number="10.4">
<h2 data-number="10.4" class="anchored" data-anchor-id="gaussian-elimination"><span class="header-section-number">10.4</span> Gaussian Elimination</h2>
<ul>
<li>You do not have to do matrix inversion to solve a matrix equation.</li>
<li>We can use Gaussian Elimination.</li>
<li>How?
<ul>
<li>Augment the matrix of coefficeints by the vector of constants, row reduce to echelon form, then use back substitution to solve for each variable.</li>
</ul></li>
<li>Example:</li>
</ul>
<p><span class="math display">\[
\begin{aligned}
    x = 4-y\\
    y = \frac{x}{2} + 2\\
    \text{Put in matrix form:}\\
    \begin{bmatrix}
        1&amp;1\\
        -\frac{1}{2}&amp;1\\
    \end{bmatrix}\begin{bmatrix}
        x\\
        y\\
    \end{bmatrix} = \begin{bmatrix}
        4\\
        2\\
    \end{bmatrix}\\
    \begin{bmatrix}
        1&amp;1\\
        -\frac{1}{2}&amp;1\\
    \end{bmatrix} \sqcup \begin{bmatrix}
        4\\
        2\\
    \end{bmatrix} = \begin{bmatrix}
        1&amp;1&amp;4\\
        -\frac{1}{2}&amp;1&amp;2\\
    \end{bmatrix}\\
    \text{Row reduce:}\\
    \begin{bmatrix}
        1&amp;1&amp;4\\
        -\frac{1}{2}&amp;1&amp;2\\
    \end{bmatrix} \xrightarrow{\frac{1}{2}R_1 + R_2} \begin{bmatrix}
        1&amp;1&amp;4\\
        0&amp;\frac{3}{2}&amp;4\\
    \end{bmatrix}\\
    \text{Back substitute:}\\
    x + y = 4\\
    \frac{3}{2}y = 4 \Rightarrow y =  \frac{8}{3} \\
    x + \frac{8}{3} = 4 \Rightarrow x = \frac{4}{3} \\
\end{aligned}
\]</span></p>
</section>
<section id="gauss-jordan-elimination" class="level2" data-number="10.5">
<h2 data-number="10.5" class="anchored" data-anchor-id="gauss-jordan-elimination"><span class="header-section-number">10.5</span> Gauss-Jordan Elimination</h2>
<ul>
<li>We need to keep reducing so that the left-most nonzero elements in the matrix, our pivots, are 1s.</li>
<li>An alternate to back substitution is that we can divide each row by it’s pivot. So, for example, we had been here: <span class="math display">\[
\begin{bmatrix}
  1&amp;1&amp;4\\
  0&amp;1&amp;\frac{8}{3}
\end{bmatrix}
\]</span></li>
<li>We can use Gauss-Jordan elimination as a trick to continue row reducing upward to get rid of elements abov each pivot. <span class="math display">\[
\begin{bmatrix}
  1&amp;1&amp;4\\
  0&amp;1&amp;\frac{8}{3}
\end{bmatrix} \xrightarrow{-R_2 + R_1} \begin{bmatrix}
  (-0+1)&amp;(-1+1)&amp;(-\frac{8}{3}+\frac{12}{3})\\
  0&amp;1&amp;\frac{8}{3}\\
\end{bmatrix}=\begin{bmatrix}
  1&amp;0&amp;\frac{4}{3}\\
  0&amp;1&amp;\frac{8}{3}\\
\end{bmatrix}
\]</span></li>
<li>Like back substitution, this produces a reduced row echelon form, RREF.</li>
<li>Remember Gauss-Jordan Elimination is just the shortcut that we can use to solve a matrix system rather than having to go back to solving a system of equations. ## Matrix inverse via Gauss-Jordan Eliminations:</li>
<li>Say that we have this: <span class="math display">\[
\begin{bmatrix}
  a&amp;b\\
  c&amp;d\\
\end{bmatrix}\begin{bmatrix}
  x_1\\
  y_1\\
\end{bmatrix} = \begin{bmatrix}
  1\\
  0
\end{bmatrix}
\]</span></li>
<li>The constants vector is the first column vector for a <span class="math inline">\(2\times 2\)</span> <span class="math inline">\(I\)</span>.</li>
<li>What this implies is that applying RREF to a square full-rank matrix augmented by the first column of the identity matrix will show the linear transformation that generates the matrix into the first column of the identity matrix. This then means that the vector <span class="math inline">\([x_1 y_1]^T\)</span> is the first column of the matrix inverse. We can then repeat this process but for the second column of the inverse.</li>
<li>Basically, this is a mechanism to find the matrix inverse without computing determinants. The draw back is that row redeuction involves a lot of division which can lead to error from lack of precision. Though it is more numerically stable than the inverse. A matrix that is close to singular or one that has a high condition number will be difficult to inverse no matter what!</li>
</ul>
</section>
<section id="lu-decomposition" class="level2" data-number="10.6">
<h2 data-number="10.6" class="anchored" data-anchor-id="lu-decomposition"><span class="header-section-number">10.6</span> LU Decomposition</h2>
<ul>
<li>Builds on row reduction by adding constraints. Doing this allows us to identify a unique echelon form, unlike what we get with row reduction alone. This is the RREF and <span class="math inline">\(U\)</span>.</li>
<li>The goal with this procedure is to decompose a given matrix into the product of two triangular matrices.</li>
<li>It relies upon row reduction.</li>
<li>The echelon form is not necessarily unique with LU decomposition.
<ul>
<li>However, by requiring that the diagonals of <span class="math inline">\(L\)</span> are 1, this makes sure that the LU decomposition is unique for a full-rank square matrix. <span class="math display">\[
A = LU
\]</span></li>
</ul></li>
<li>A numerical example:
<ul>
<li>We have the following matrix: <span class="math display">\[
\begin{bmatrix}
  2&amp;2&amp;4\\
  1&amp;0&amp;3\\
  2&amp;1&amp;2\\
\end{bmatrix}
\]</span></li>
<li>We can do <span class="math inline">\(L^{-1}A=U\)</span> with row reduction like before to get the transformation matrix that transforms <span class="math inline">\(A\)</span> into the echelon form, <span class="math inline">\(U\)</span> (which is an upper-triangle).</li>
</ul></li>
</ul>
<p><span class="math display">\[
\begin{bmatrix}
    2&amp;2&amp;4\\
    1&amp;0&amp;3\\
    2&amp;1&amp;2\\
\end{bmatrix} = \begin{bmatrix}
    1&amp;0&amp;0\\
    \frac{1}{2}&amp;1&amp;0\\
    1&amp;1&amp;1\\
\end{bmatrix}\begin{bmatrix}
    2&amp;2&amp;4\\
    0&amp;-1&amp;1\\
    0&amp;0&amp;-3\\
\end{bmatrix}
\]</span></p>
<div id="lu-decomp" class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Define matrix.</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>A <span class="op">=</span> [[<span class="fl">2</span>,<span class="fl">1</span>,<span class="fl">2</span>] [<span class="fl">2</span>,<span class="fl">0</span>,<span class="fl">1</span>] [<span class="fl">4</span>,<span class="fl">3</span>,<span class="fl">2</span>]]</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="fu">println</span>(<span class="st">"A = </span><span class="sc">$</span>A<span class="st">"</span>)</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform LU decomposition.</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>A_LU_all <span class="op">=</span> <span class="bu">LinearAlgebra</span>.<span class="fu">lu</span>(A)</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>L <span class="op">=</span> A_LU_all.L</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>U <span class="op">=</span> A_LU_all.U</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a><span class="fu">println</span>(<span class="st">"L = </span><span class="sc">$</span>L<span class="st">"</span>)</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a><span class="fu">println</span>(<span class="st">"U = </span><span class="sc">$</span>U<span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>A = [2 2 4; 1 0 3; 2 1 2]
L = [1.0 0.0 0.0; 0.5 1.0 0.0; 1.0 1.0 1.0]
U = [2.0 2.0 4.0; 0.0 -1.0 1.0; 0.0 0.0 -3.0]</code></pre>
</div>
</div>
</section>
<section id="row-swapping-with-permutation-matrices" class="level2" data-number="10.7">
<h2 data-number="10.7" class="anchored" data-anchor-id="row-swapping-with-permutation-matrices"><span class="header-section-number">10.7</span> Row swapping with Permutation matrices</h2>
<ul>
<li>Some matrices are hard to transform into upper-triangular form.</li>
<li>We can swap rows to help put it in echelon form and then perform row reduction from there. This is done with a permutation matrix.</li>
<li>Numerical example:
<ul>
<li>Original matrix <span class="math display">\[
  \begin{bmatrix}
  3&amp;2&amp;1\\
  0&amp;5&amp;5\\
  0&amp;7&amp;2\\
  \end{bmatrix}
  \]</span></li>
<li>Row swapping with the permutation matrix, <span class="math inline">\(P\)</span>: <span class="math display">\[
  \begin{bmatrix}
  1&amp;0&amp;0\\
  0&amp;1&amp;1\\
  0&amp;1&amp;0\\
  \end{bmatrix}\begin{bmatrix}
  3&amp;2&amp;1\\
  0&amp;5&amp;5\\
  0&amp;7&amp;2\\
  \end{bmatrix} = \begin{bmatrix}
  3&amp;2&amp;1\\
  0&amp;7&amp;2\\
  0&amp;0&amp;5\\
  \end{bmatrix}
  \]</span></li>
</ul></li>
<li>Often this is required with LU decomposition. So technically, LU decomposition is denoted as: <span class="math display">\[
PA = LU\\
A = P^TLU
\]</span></li>
<li>Permutation matrices are orthogonal. Which means <span class="math inline">\(P^{-1} = P^T\)</span> and <span class="math inline">\(P^TP = I\)</span>.</li>
</ul>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./ch_9.html" class="pagination-link  aria-label=" &lt;span="" matrices="" and="" qr="" decomposition.&lt;="" span&gt;"="">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Orthogonal matrices and QR decomposition.</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./ch_11.html" class="pagination-link" aria-label="<span class='chapter-number'>11</span>&nbsp; <span class='chapter-title'>General Linear Models (GLM) and Least Squares</span>">
        <span class="nav-page-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">General Linear Models (GLM) and Least Squares</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




</body></html>